<?php

namespace Tests\Feature\Http\Controllers;

use App\Models\Vulnerability;
use Illuminate\Foundation\Testing\RefreshDatabase;
use Tests\TestCase;

class VulnerabilityControllerTest extends TestCase
{
    use RefreshDatabase;
    public function test_it_should_show_all_vulnerabilities_paginated(): void
    {
        $response = $this->get('/api/vulnerabilities');
        $this->assertEquals(Vulnerability::query()->take(10)->get()->toArray(),$response->json()['data']);
    }

    public function test_it_should_show_specific_vulnerability(): void
    {
        $vulnerability = Vulnerability::query()->first();
        $response = $this->get('/api/vulnerabilities/'.$vulnerability->id);
        $this->assertEquals($vulnerability->toArray(),$response->json()['data']);
    }
}
